@using System.Security.Claims;
@inject AuthenticationStateProvider _authProvider;
@inject NavigationManager _navManager;

<MudNavMenu Color="Color.Primary">
  


    @*  <MudNavLink Href="/login" Icon="@Icons.Material.Filled.MapsHomeWork">Login</MudNavLink> *@
    <AuthorizeView Roles="Admin">
        <MudNavMenu>
            <MudNavGroup Icon="@Icons.Material.Filled.SignalCellularAlt" Title="Thống kê">
                <MudNavLink Href="/statistic/roombookingstatistic">Thống kê phòng</MudNavLink>
                <MudNavLink Href="/statistic/serviceOrderStatistic">Thống kê dịch vụ</MudNavLink>
                <MudNavLink Href="/statistic/billstatistic">Thống kê doanh số </MudNavLink>
            </MudNavGroup>
        </MudNavMenu>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/roleService" Icon="fa-solid fa-circle-user">Quản lý chức vụ</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/building" Icon="@Icons.Material.Filled.MapsHomeWork">Quản lý tòa nhà</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/floorlistp2" Icon="fa-solid fa-house-flood-water">Quản lý tầng tòa nhà</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/amenity" Icon="fa-solid fa-menorah">Quản lý tiện ích khách sạn</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/roomtype" Icon="@Icons.Material.Filled.MeetingRoom">Quản lý loại phòng</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/roomdetail" Icon="@Icons.Material.Filled.BedroomParent">Quản lý phòng chi tiết</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/servicetype" Icon="fa-brands fa-servicestack">Quản lý loại dịch vụ</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin">
        <MudNavLink Href="/service" Icon="@Icons.Material.Filled.RoomService">Quản lý dịch vụ</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin,Nhân viên">
        
        <MudNavLink Href="/roombooking" Icon="fa-solid fa-building-user">Quản lý đặt phòng</MudNavLink>
        <MudNavLink Href="/serviceOrder" Icon="fa-brands fa-usps">Quản lý dịch vụ đã đặt</MudNavLink>
    </AuthorizeView>
    <AuthorizeView Roles="Admin,Nhân viên">
        <MudNavMenu>
            <MudNavGroup Icon="@Icons.Material.Filled.Article" Title="Quản lí hóa đơn">
                <MudNavLink Href="/bill/room">Hóa đơn cho phòng</MudNavLink>
                <MudNavLink Href="/bill/service">Hóa đơn cho dịch vụ</MudNavLink>
            </MudNavGroup>
        </MudNavMenu>
    </AuthorizeView>
    <AuthorizeView Roles="Admin,Nhân viên">
        <MudNavMenu>
            <MudNavGroup Icon="fa-solid fa-people-group" Title="Quản lý khách hàng">
                <MudNavLink Href="/admin/customerList">Thông tin khách hàng</MudNavLink>
                <MudNavLink Href="/admin/customerRoomBooking">Thông tin đặt phòng</MudNavLink>
                <MudNavLink Href="/staff/RoomBooking">Danh sách chờ duyệt</MudNavLink>
                <MudNavLink Href="/admin/customerRoomBookingHistory">Lịch sử đặt phòng</MudNavLink>
            </MudNavGroup>
        </MudNavMenu>
    </AuthorizeView>
    @if (!_lstrole.Any(x => x == "Nhân viên"))
    {
        <MudNavMenu>
            <MudNavGroup Icon="@Icons.Material.Filled.PeopleOutline" Title="Khách hàng">
                <MudNavLink Href="/customer/PersonalInformation">Thông tin cá nhân</MudNavLink>
                <MudNavLink Href="/customer/RoomType">Đặt phòng</MudNavLink>
                <MudNavLink Href="/customer/RoomBooking">Thông tin đặt phòng</MudNavLink>
                <MudNavLink Href="/customer/RoomBookingHistory">Lịch sử đặt phòng</MudNavLink>
                <MudNavLink Href="/customer/Bill">Xem hóa đơn phòng</MudNavLink>
                <MudNavLink Href="/customer/BillService">Xem hóa đơn dịch vụ</MudNavLink>
            </MudNavGroup>
        </MudNavMenu>
    }
    

    <AuthorizeView Roles="Admin,Nhân viên">

        <MudNavLink Icon="@Icons.Material.Filled.ExitToApp" IconColor="Color.Error" @onclick="@(async () => await OnClickLogOut())">
            Đăng xuất
        </MudNavLink>
    </AuthorizeView>
</MudNavMenu>

@code {
    private MudTheme _customTheme = new()
        {
            Palette = new Palette()
            {
                Primary = "#F97E0C"
            }
        };

    private List<string> _lstrole = new();



    protected override async Task OnInitializedAsync()
    {
        var authState = await _authProvider.GetAuthenticationStateAsync();
        var authUser = authState.User;
        _lstrole = authUser.FindAll(ClaimTypes.Role).Select(c => c.Value).ToList();


    }
    private async Task HandleNavLinkClick()
    {
        // Perform any necessary logic before navigation
        // Prevent the default behavior
        await Task.CompletedTask;
    }

    private async Task OnClickLogOut()
    {
        _navManager.NavigateTo("/login");

    }
}
